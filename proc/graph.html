<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="generate basic XY plots">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>graph &ndash; M_graph</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

         <script src="../js/jquery-2.1.3.min.js"></script>
         <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">M_graph </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
                 data-toggle="dropdown" role="button"
                 aria-haspopup="true"
                 aria-expanded="false">
                 Contents <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                    <li><a href="../lists/files.html">Source Files</a></li>
                  <li><a href="../lists/modules.html">Modules</a></li>
                  <li><a href="../lists/procedures.html">Procedures</a></li>
                  <li><a href="../lists/types.html">Derived Types</a></li>
                  <li><a href="../lists/programs.html">Programs</a></li>
              </ul>
            </li>
                <li class="visible-xs hidden-sm visible-lg">
                  <a href="../lists/files.html">Source Files</a>
                </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/modules.html">Modules</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/procedures.html">Procedures</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/types.html">Derived Types</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/programs.html">Programs</a>
              </li>
          </ul>
            <form action="../search.html" class="navbar-form navbar-right" role="search">
              <div class="form-group">
                <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
              </div>
              <!--
                  <button type="submit" class="btn btn-default">Submit</button>
                  -->
            </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>graph
      <small>Subroutine</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="87.7% of total for procedures.">627 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/M_graph.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/m_graph.f90.html'>M_graph.f90</a></li>
              <li><a href='../module/m_graph.html'>m_graph</a></li>
          <li class="active">graph</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/graph.html#src">graph</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine graph(x, y, ndp, ndl, f, C, nc)  
</h2>
    

    <h2 id="name">NAME</h2>
<div class="codehilite"><pre><span></span><code>graph(3) - [M_graph::INTRO] Draw an XY graph
</code></pre></div>

<h2 id="synopsis">SYNOPSIS</h2>
<div class="codehilite"><pre><span></span><code>subroutine graph(x,y,ndp,ndl,f,c,nc)
</code></pre></div>

<h2 id="description">DESCRIPTION</h2>
<div class="codehilite"><pre><span></span><code><span class="n">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">XY</span><span class="w"> </span><span class="n">graph</span><span class="w"> </span><span class="n">routine</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">intended</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="bp">self</span><span class="o">-</span><span class="n">contained</span><span class="w"> </span><span class="ow">and</span><span class="w"></span>
<span class="n">easily</span><span class="w"> </span><span class="n">ported</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">various</span><span class="w"> </span><span class="n">graphics</span><span class="w"> </span><span class="n">libraries</span><span class="o">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">callable</span><span class="w"> </span><span class="n">from</span><span class="w"></span>
<span class="n">the</span><span class="w"> </span><span class="n">M_draw</span><span class="p">(</span><span class="mi">3</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="n">module</span><span class="o">.</span><span class="w"></span>

<span class="n">It</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">ported</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">LONGLIB</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"></span>
<span class="n">changing</span><span class="o">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">recommended</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">rename</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">M_graph</span><span class="p">(</span><span class="mi">3</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="n">source</span><span class="w"></span>
<span class="n">to</span><span class="w"> </span><span class="n">freeze</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">point</span><span class="p">,</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">necessarily</span><span class="w"> </span><span class="n">be</span><span class="w"></span>
<span class="n">upward</span><span class="w"> </span><span class="n">compatible</span><span class="o">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">underlying</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">M_graph</span><span class="p">(</span><span class="mi">3</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">require</span><span class="w"></span>
<span class="n">any</span><span class="w"> </span><span class="n">changes</span><span class="o">.</span><span class="w"></span>

<span class="n">graph</span><span class="p">(</span><span class="mi">3</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">routine</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">plotting</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">scatterplots</span><span class="o">.</span><span class="w"> </span><span class="n">Optionally</span><span class="p">,</span><span class="w"></span>
<span class="n">error</span><span class="w"> </span><span class="n">bars</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">symbols</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">added</span><span class="o">.</span><span class="w"> </span><span class="n">graph</span><span class="p">(</span><span class="mi">3</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="n">differs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">philosophy</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">other</span><span class="w"></span>
<span class="n">libDL</span><span class="w"> </span><span class="n">MASTER</span><span class="w"> </span><span class="n">routines</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">plotting</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">array</span><span class="o">.</span><span class="w"></span>
<span class="n">The</span><span class="w"> </span><span class="n">routine</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">designed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">produce</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">reasonable</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="n">set</span><span class="w"></span>
<span class="n">to</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">zeros</span><span class="o">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">initializing</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="n">array</span><span class="w"></span>
<span class="n">elements</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="n">below</span><span class="o">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">permits</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">flexible</span><span class="w"></span>
<span class="n">specification</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="n">format</span><span class="o">.</span><span class="w"></span>
</code></pre></div>

<h2 id="options">OPTIONS</h2>
<div class="codehilite"><pre><span></span><code><span class="n">x</span><span class="w">     </span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="n">dimensioned</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">ndp</span><span class="p">,</span><span class="n">ndl</span><span class="p">).</span><span class="w"></span>
<span class="n">y</span><span class="w">     </span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="n">dimensioned</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">ndp</span><span class="p">,</span><span class="n">ndl</span><span class="p">).</span><span class="w"></span>
<span class="n">ndp</span><span class="w">   </span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="n">points</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">line</span><span class="w"></span>
<span class="n">ndl</span><span class="w">   </span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="n">lines</span><span class="w"></span>
<span class="n">f</span><span class="w">     </span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="k">option</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="n">dimensioned</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span><span class="w"></span>

<span class="w">           </span><span class="p">(</span><span class="n">described</span><span class="w"> </span><span class="n">below</span><span class="p">)</span><span class="w"></span>
<span class="n">c</span><span class="w">     </span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">strings</span><span class="w"> </span><span class="n">dimensioned</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">ndl</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">title</span><span class="w"></span>
<span class="w">            </span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">title</span><span class="w"></span>
<span class="w">            </span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">top</span><span class="w"> </span><span class="n">title</span><span class="w"></span>
<span class="w">            </span><span class="n">c</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="p">(</span><span class="n">optionally</span><span class="w"> </span><span class="n">used</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">c</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="p">(</span><span class="n">optionally</span><span class="w"> </span><span class="n">used</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">...</span><span class="w">        </span><span class="p">...</span><span class="w"></span>
<span class="n">nc</span><span class="w">    </span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">lengths</span><span class="w"> </span><span class="n">dimensioned</span><span class="w"> </span><span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">ndl</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">             </span><span class="p">...</span><span class="w">       </span><span class="p">...</span><span class="w"></span>

<span class="n">The</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">option</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">according</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="n">following</span><span class="w"> </span><span class="nc">table</span><span class="p">.</span><span class="w"> </span><span class="ow">Some</span><span class="w"> </span><span class="k">parameters</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="n">shown</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nf">square</span><span class="w"></span>
<span class="n">brackets</span><span class="p">).</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">zero</span><span class="p">.</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"></span>
<span class="n">produced</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">zero</span><span class="p">.</span><span class="w"> </span><span class="n">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">specified</span><span class="w"></span>
<span class="k">input</span><span class="w"> </span><span class="n">scaling</span><span class="w"> </span><span class="n">factors</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">powers</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ten</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">specification</span><span class="w"></span>
<span class="k">is</span><span class="w"> </span><span class="n">selected</span><span class="p">.</span><span class="w"> </span><span class="n">An</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">plotted</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">column</span><span class="w"></span>
<span class="k">of</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">n</span><span class="p">(</span><span class="mi">4</span><span class="err">:</span><span class="p">)</span><span class="w"></span>

<span class="w">  </span><span class="k">array</span><span class="w">  </span><span class="k">range</span><span class="w"> </span><span class="k">of</span><span class="w"></span>
<span class="w">  </span><span class="k">index</span><span class="w">  </span><span class="k">values</span><span class="w">   </span><span class="k">action</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="k">value</span><span class="w"></span>
<span class="w"> </span><span class="o">-------</span><span class="w"> </span><span class="o">--------</span><span class="w"> </span><span class="o">------------------------</span><span class="w"></span>

<span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">0</span><span class="o">&lt;=</span><span class="p">.</span><span class="o">&lt;=</span><span class="n">ndp</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">points</span><span class="o">/</span><span class="n">line</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="o">[</span><span class="n">ndp</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">ndp</span><span class="w"> </span><span class="n">used</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span><span class="w">    </span><span class="mi">0</span><span class="o">&lt;=</span><span class="p">.</span><span class="o">&lt;=</span><span class="n">ndl</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="o">[</span><span class="n">nl</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">ndl</span><span class="w"> </span><span class="n">used</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span><span class="w">     </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">   </span><span class="n">x</span><span class="w"> </span><span class="nl">scale</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span><span class="n">smoothed</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span><span class="n">nosmooth</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">=</span><span class="k">user</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span><span class="w">      </span><span class="n">xmin</span><span class="w">    </span><span class="k">user</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="p">(</span><span class="n">used</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span><span class="w">      </span><span class="n">xmax</span><span class="w">    </span><span class="k">user</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="p">(</span><span class="n">used</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span><span class="w">     </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">   </span><span class="n">y</span><span class="w"> </span><span class="nl">scale</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span><span class="n">smoothed</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span><span class="n">nosmooth</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">=</span><span class="k">user</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span><span class="w">      </span><span class="n">ymin</span><span class="w">    </span><span class="k">user</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="p">(</span><span class="n">used</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span><span class="w">      </span><span class="n">ymax</span><span class="w">    </span><span class="k">user</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="p">(</span><span class="n">used</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span><span class="w">      </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">x</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="k">usage</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">first</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="k">array</span><span class="w"></span>
<span class="w">                  </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">lines</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">lines</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="w"> </span><span class="n">paired</span><span class="w"></span>
<span class="w">   </span><span class="mi">10</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="k">connect</span><span class="w"> </span><span class="n">plotted</span><span class="w"> </span><span class="nl">points</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">yes</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="k">no</span><span class="w"></span>
<span class="w">   </span><span class="mi">11</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">symbol</span><span class="w"> </span><span class="n">plotted</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="p">()</span><span class="n">th</span><span class="w"> </span><span class="nl">point</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="w"> </span><span class="n">symbols</span><span class="w"></span>
<span class="w">   </span><span class="mi">12</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">line</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="o">[</span><span class="n">0.1</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">use</span><span class="w"> </span><span class="k">default</span><span class="w"></span>
<span class="w">   </span><span class="mi">13</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">symbol</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">line</span><span class="w"></span>
<span class="w">                  </span><span class="k">then</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">sequence</span><span class="w"></span>
<span class="w">   </span><span class="mi">14</span><span class="w">     </span><span class="mi">8</span><span class="o">&lt;</span><span class="p">.</span><span class="o">&lt;</span><span class="mi">8</span><span class="w">   </span><span class="n">error</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="k">option</span><span class="w"> </span><span class="p">(</span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">bars</span><span class="w"></span>
<span class="w">   </span><span class="mi">16</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">error</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="o">[</span><span class="n">0.1</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">default</span><span class="w"> </span><span class="n">used</span><span class="w"></span>
<span class="w">   </span><span class="mi">17</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">vertical</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">points</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="w"></span>
<span class="w">                  </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">yes</span><span class="w"></span>
<span class="w">   </span><span class="mi">18</span><span class="w">     </span><span class="n">rval</span><span class="w">    </span><span class="n">reference</span><span class="w"> </span><span class="k">value</span><span class="w"></span>
<span class="w">   </span><span class="mi">19</span><span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">   </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">linear</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="nf">log</span><span class="w"> </span><span class="n">axis</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">=</span><span class="k">no</span><span class="w"> </span><span class="n">axis</span><span class="w"></span>
<span class="w">   </span><span class="mi">20</span><span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">   </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">linear</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="nf">log</span><span class="w"> </span><span class="n">axis</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">=</span><span class="k">no</span><span class="w"> </span><span class="n">axis</span><span class="w"></span>
<span class="w">   </span><span class="mi">21</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">[</span><span class="n">7.0</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">default</span><span class="w"> </span><span class="n">used</span><span class="w"></span>
<span class="w">   </span><span class="mi">22</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">[</span><span class="n">5.0</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">default</span><span class="w"> </span><span class="n">used</span><span class="w"></span>
<span class="w">   </span><span class="mi">23</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">tick</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="p">(</span><span class="n">see</span><span class="w"> </span><span class="n">axisc_</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">7.00</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">default</span><span class="w"></span>
<span class="w">   </span><span class="mi">24</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">tick</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="p">(</span><span class="n">see</span><span class="w"> </span><span class="n">axisc_</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">5.00</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">default</span><span class="w"></span>
<span class="w">   </span><span class="mi">25</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nl">axis</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">below</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">above</span><span class="w"></span>
<span class="w">   </span><span class="mi">26</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nl">axis</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="nf">left</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="nf">right</span><span class="w"></span>
<span class="w">   </span><span class="mi">27</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">auto</span><span class="w"> </span><span class="n">exponent</span><span class="w"> </span><span class="nl">enable</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">enable</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">disable</span><span class="w"></span>
<span class="w">   </span><span class="mi">28</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">auto</span><span class="w"> </span><span class="n">exponent</span><span class="w"> </span><span class="nl">enable</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">enable</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">disable</span><span class="w"></span>
<span class="w">   </span><span class="mi">29</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">tick</span><span class="w"> </span><span class="nl">side</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">below</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">above</span><span class="w"></span>
<span class="w">   </span><span class="mi">30</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">tick</span><span class="w"> </span><span class="nl">side</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="nf">left</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="nf">right</span><span class="w"></span>
<span class="w">   </span><span class="mi">31</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="nl">orientation</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">horizontal</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">vertical</span><span class="w"></span>
<span class="w">   </span><span class="mi">32</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="nl">orientation</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">vertical</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">horizontal</span><span class="w"></span>
<span class="w">   </span><span class="mi">33</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">numbers</span><span class="o">/</span><span class="nl">title</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">shown</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="ow">not</span><span class="w"> </span><span class="n">shown</span><span class="w"></span>
<span class="w">   </span><span class="mi">34</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">numbers</span><span class="o">/</span><span class="nl">title</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">shown</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="ow">not</span><span class="w"> </span><span class="n">shown</span><span class="w"></span>
<span class="w">   </span><span class="mi">35</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="k">use</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="nf">log10</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="k">values</span><span class="p">)</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">yes</span><span class="w"></span>
<span class="w">   </span><span class="mi">36</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="k">use</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="nf">log10</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="k">values</span><span class="p">)</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">yes</span><span class="w"></span>
<span class="w">   </span><span class="mi">37</span><span class="w">   </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">    </span><span class="k">add</span><span class="w"> </span><span class="n">mirror</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="nl">axis</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="n">labels</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="err">:</span><span class="n">w</span><span class="o">/</span><span class="n">o</span><span class="w"> </span><span class="n">labels</span><span class="w"></span>
<span class="w">   </span><span class="mi">38</span><span class="w">   </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">    </span><span class="k">add</span><span class="w"> </span><span class="n">mirror</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="nl">axis</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="n">labels</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="err">:</span><span class="n">w</span><span class="o">/</span><span class="n">o</span><span class="w"> </span><span class="n">labels</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">mirrored</span><span class="w"> </span><span class="n">axes</span><span class="w"> </span><span class="n">placed</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">opposite</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">axis</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="mi">39</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="o">[</span><span class="n">0.15</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">use</span><span class="w"> </span><span class="k">default</span><span class="w"></span>
<span class="w">   </span><span class="mi">40</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="o">[</span><span class="n">0.15</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">use</span><span class="w"> </span><span class="k">default</span><span class="w"></span>
<span class="w">   </span><span class="mi">41</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="k">top</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="k">character</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="o">[</span><span class="n">0.18</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">use</span><span class="w"> </span><span class="k">default</span><span class="w"></span>
<span class="w">   </span><span class="mi">42</span><span class="w">   </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="w">   </span><span class="nl">grid</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="w"> </span><span class="n">grid</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">solid</span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="o">=</span><span class="n">dotted</span><span class="p">;</span><span class="w"> </span><span class="mi">3</span><span class="o">=</span><span class="n">ticked</span><span class="w"></span>
<span class="w">   </span><span class="mi">43</span><span class="w">   </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">    </span><span class="nl">legend</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="w"> </span><span class="n">legend</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="nf">right</span><span class="w"> </span><span class="n">side</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">=</span><span class="k">user</span><span class="w"> </span><span class="n">locate</span><span class="w"></span>
<span class="w">   </span><span class="mi">44</span><span class="w">     </span><span class="n">xval</span><span class="w">    </span><span class="k">user</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="nf">lower</span><span class="o">-</span><span class="nf">left</span><span class="w"> </span><span class="n">corner</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">legend</span><span class="w"></span>
<span class="w">   </span><span class="mi">45</span><span class="w">     </span><span class="n">yval</span><span class="w">    </span><span class="k">user</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="nf">lower</span><span class="o">-</span><span class="nf">left</span><span class="w"> </span><span class="n">corner</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">legend</span><span class="w"></span>
<span class="w">   </span><span class="mi">46</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">show</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="nl">legend</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">yes</span><span class="w"></span>
<span class="w">   </span><span class="mi">47</span><span class="w">     </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">show</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">segment</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="nl">legend</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">yes</span><span class="w"></span>
<span class="w">   </span><span class="mi">48</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">legend</span><span class="w"> </span><span class="k">character</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">[</span><span class="n">0.12</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">use</span><span class="w"> </span><span class="k">default</span><span class="w"></span>
<span class="w">   </span><span class="mi">49</span><span class="w">     </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">     </span><span class="n">legend</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">segment</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">[</span><span class="n">0.5</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">use</span><span class="w"> </span><span class="k">default</span><span class="w"></span>
<span class="w">   </span><span class="mi">50</span><span class="w">   </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">    </span><span class="k">top</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="nl">justify</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">center</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="err">:</span><span class="nf">left</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="nf">right</span><span class="w"></span>
<span class="w">   </span><span class="mi">51</span><span class="w">    </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">      </span><span class="n">plot</span><span class="w"> </span><span class="n">horizontal</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="nl">line</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">yes</span><span class="w"></span>
<span class="w">   </span><span class="mi">52</span><span class="w">    </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">      </span><span class="k">use</span><span class="w"> </span><span class="n">linetype</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="k">values</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">yes</span><span class="w"></span>
<span class="w">   </span><span class="mi">53</span><span class="w">    </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="w">      </span><span class="k">use</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="k">values</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="k">no</span><span class="p">;</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="n">yes</span><span class="w"></span>
<span class="w">   </span><span class="mi">54</span><span class="w">    </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">      </span><span class="n">color</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="n">#1</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">color</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">used</span><span class="w"></span>
<span class="w">   </span><span class="mi">55</span><span class="w">    </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">      </span><span class="n">linetype</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="n">#1</span><span class="w"></span>
<span class="w">   </span><span class="mi">56</span><span class="w">    </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">      </span><span class="n">color</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="n">#2</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="o">=</span><span class="n">color</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">used</span><span class="w"></span>
<span class="w">   </span><span class="mi">57</span><span class="w">    </span><span class="o">&gt;=</span><span class="mi">0</span><span class="w">      </span><span class="n">linetype</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="n">#2</span><span class="w"></span>
<span class="w">   </span><span class="p">...</span><span class="w">   </span><span class="p">...</span><span class="w">      </span><span class="p">...</span><span class="w"> </span><span class="n">etc</span><span class="w"> </span><span class="p">...</span><span class="w"></span>

<span class="n">The</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="n">specification</span><span class="p">,</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">interpretation</span><span class="w"> </span><span class="k">of</span><span class="w"></span>
<span class="n">lines</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="p">(</span><span class="ow">and</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="n">third</span><span class="w"> </span><span class="n">line</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">considered</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ss">&quot;center&quot;</span><span class="w"> </span><span class="n">line</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"></span>
<span class="k">second</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">relative</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">(</span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">line</span><span class="p">)</span><span class="w"> </span><span class="n">used</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="n">plotting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tops</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">bars</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">third</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">similarly</span><span class="w"> </span><span class="k">to</span><span class="w"></span>
<span class="n">locate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bottoms</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">bars</span><span class="p">.</span><span class="w"> </span><span class="k">When</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="n">specification</span><span class="w"> </span><span class="k">is</span><span class="w"></span>
<span class="n">negative</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">center</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">points</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">marked</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="ss">&quot;x&quot;</span><span class="w"> </span><span class="p">(</span><span class="ow">in</span><span class="w"> </span><span class="n">addition</span><span class="w"> </span><span class="k">to</span><span class="w"></span>
<span class="ow">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="k">option</span><span class="p">).</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">absolution</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specification</span><span class="w"> </span><span class="n">determines</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"></span>
<span class="k">of</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="n">according</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="nc">table</span><span class="p">.</span><span class="w"></span>

<span class="w"> </span><span class="k">value</span><span class="w">   </span><span class="n">type</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">bar</span><span class="w"></span>
<span class="w"> </span><span class="o">------</span><span class="w">  </span><span class="o">---------------------------------------------------</span><span class="w"></span>
<span class="w">  </span><span class="mi">1</span><span class="w">     </span><span class="n">line</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="k">relative</span><span class="w"> </span><span class="n">errors</span><span class="w"></span>
<span class="w">  </span><span class="mi">2</span><span class="w">     </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">horizontal</span><span class="w"> </span><span class="n">bars</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="k">relative</span><span class="w"> </span><span class="n">errs</span><span class="w"></span>
<span class="w">  </span><span class="mi">3</span><span class="w">     </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vertical</span><span class="w"> </span><span class="n">bars</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="k">relative</span><span class="w"> </span><span class="n">errs</span><span class="w"></span>
<span class="w">  </span><span class="mi">4</span><span class="w">     </span><span class="k">double</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">rel</span><span class="p">.</span><span class="w"> </span><span class="n">errs</span><span class="o">+</span><span class="n">horizontal</span><span class="w"> </span><span class="n">bars</span><span class="w"></span>
<span class="w">  </span><span class="mi">5</span><span class="w">     </span><span class="k">double</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">rel</span><span class="p">.</span><span class="w"> </span><span class="n">errs</span><span class="o">+</span><span class="n">vertical</span><span class="w"> </span><span class="n">bars</span><span class="w"></span>
<span class="w">  </span><span class="mi">6</span><span class="w">     </span><span class="n">vertical</span><span class="w"> </span><span class="n">rectangle</span><span class="w"> </span><span class="n">w</span><span class="o">/</span><span class="k">top</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">bottom</span><span class="w"> </span><span class="n">rel</span><span class="p">.</span><span class="w"> </span><span class="n">errs</span><span class="w"></span>
<span class="w">  </span><span class="mi">7</span><span class="w">     </span><span class="n">rectangle</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">corners</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="k">relative</span><span class="w"> </span><span class="n">errors</span><span class="w"></span>

<span class="n">The</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="p">(</span><span class="k">when</span><span class="w"> </span><span class="n">enabled</span><span class="p">)</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">according</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="n">following</span><span class="w"> </span><span class="nc">table</span><span class="p">.</span><span class="w"></span>

<span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="err">#</span><span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="k">usage</span><span class="w">     </span><span class="n">linetype</span><span class="w"> </span><span class="k">usage</span><span class="w"></span>
<span class="w"> </span><span class="o">---------</span><span class="w">      </span><span class="o">-------------</span><span class="w">   </span><span class="o">----------------</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span><span class="w">              </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w">         </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span><span class="w">           </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">numbers</span><span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span><span class="w">           </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">title</span><span class="w">      </span><span class="n">title</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span><span class="w">           </span><span class="n">x</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">exponent</span><span class="w">   </span><span class="n">legend</span><span class="w"> </span><span class="n">titles</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span><span class="w">              </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w">         </span><span class="n">reference</span><span class="w"> </span><span class="n">line</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span><span class="w">           </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">numbers</span><span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="n">bars</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span><span class="w">           </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">title</span><span class="w">      </span><span class="n">line</span><span class="w"> </span><span class="n">#1</span><span class="w"> </span><span class="n">linetype</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span><span class="w">           </span><span class="n">y</span><span class="w"> </span><span class="n">axis</span><span class="w"> </span><span class="n">exponent</span><span class="w">   </span><span class="n">line</span><span class="w"> </span><span class="n">#2</span><span class="w"> </span><span class="n">linetype</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span><span class="w">              </span><span class="n">title</span><span class="w">            </span><span class="n">etc</span><span class="p">.</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span><span class="w">             </span><span class="n">legend</span><span class="w"> </span><span class="n">titles</span><span class="w">     </span><span class="p">...</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span><span class="w">            </span><span class="n">reference</span><span class="w"> </span><span class="n">line</span><span class="w">     </span><span class="p">...</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span><span class="w">               </span><span class="n">grid</span><span class="w">            </span><span class="p">...</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span><span class="w">             </span><span class="n">line</span><span class="w"> </span><span class="n">#1</span><span class="w"> </span><span class="n">color</span><span class="w">     </span><span class="p">...</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span><span class="w">             </span><span class="n">line</span><span class="w"> </span><span class="n">#2</span><span class="w"> </span><span class="n">color</span><span class="w">     </span><span class="p">...</span><span class="w"></span>
<span class="w">  </span><span class="p">...</span><span class="w">            </span><span class="p">...</span><span class="w"> </span><span class="n">etc</span><span class="p">.</span><span class="w"> </span><span class="p">...</span><span class="w">      </span><span class="p">...</span><span class="w"></span>
</code></pre></div>

<h2 id="example">EXAMPLE</h2>
<p>Sample program that creates some simple curves and then
   prompts for index values and values in the options array
   to allow for testing various options.</p>
<div class="codehilite"><pre><span></span><code><span class="nv">program</span> <span class="nv">demo_graph</span>
<span class="nv">use</span> <span class="nv">m_graph</span>, <span class="nv">only</span> : <span class="nv">graph</span>, <span class="nv">graph_init</span>
<span class="nv">use</span> <span class="nv">M_draw</span>
<span class="nv">implicit</span> <span class="nv">none</span>

<span class="nv">integer</span>,<span class="nv">parameter</span>            :: <span class="nv">numlines</span><span class="o">=</span><span class="mi">3</span>
<span class="nv">integer</span>,<span class="nv">parameter</span>            :: <span class="nv">numpts</span><span class="o">=</span><span class="mi">25</span>
<span class="nv">integer</span>,<span class="nv">parameter</span>            :: <span class="nv">nf</span><span class="o">=</span><span class="mi">255</span>
<span class="nv">real</span>                         :: <span class="nv">x</span><span class="ss">(</span><span class="nv">numpts</span><span class="ss">)</span>,<span class="nv">y</span><span class="ss">(</span><span class="nv">numpts</span>,<span class="nv">numlines</span><span class="ss">)</span>
<span class="nv">character</span><span class="ss">(</span><span class="nv">len</span><span class="o">=</span><span class="mi">80</span><span class="ss">)</span>            :: <span class="nv">c</span><span class="ss">(</span><span class="nv">numlines</span><span class="o">+</span><span class="mi">3</span><span class="ss">)</span>
<span class="nv">integer</span>                      :: <span class="nv">nc</span><span class="ss">(</span><span class="nv">numlines</span><span class="o">+</span><span class="mi">3</span><span class="ss">)</span>
<span class="nv">real</span>                         :: <span class="nv">f</span><span class="ss">(</span><span class="nv">nf</span><span class="ss">)</span>
<span class="nv">character</span><span class="ss">(</span><span class="nv">len</span><span class="o">=</span><span class="mi">20</span><span class="ss">)</span>            :: <span class="nv">device</span>
<span class="nv">integer</span>                      :: <span class="nv">ixsize</span>
<span class="nv">integer</span>                      :: <span class="nv">iysize</span>
<span class="nv">character</span><span class="ss">(</span><span class="nv">len</span><span class="o">=</span>:<span class="ss">)</span>,<span class="nv">allocatable</span> :: <span class="nv">filename</span>
<span class="nv">integer</span>                      :: <span class="nv">w</span>, <span class="nv">ndl</span>, <span class="nv">ndp</span>
<span class="nv">integer</span>                      :: <span class="nv">i20</span>, <span class="nv">i70</span>, <span class="nv">i60</span>, <span class="nv">indx</span>
<span class="nv">real</span>                         :: <span class="nv">value</span>
   <span class="nv">device</span><span class="o">=</span><span class="s1">&#39;</span><span class="s">x11</span><span class="s1">&#39;</span>
   <span class="nv">ixsize</span><span class="o">=</span><span class="mi">1200</span><span class="o">*</span>.<span class="mi">75</span><span class="o">*</span><span class="mi">0</span>.<span class="mi">5</span>
   <span class="nv">iysize</span><span class="o">=</span><span class="mi">900</span><span class="o">*</span>.<span class="mi">75</span><span class="o">*</span><span class="mi">0</span>.<span class="mi">5</span>
   <span class="nv">w</span><span class="o">=</span><span class="mi">40</span>
   <span class="k">if</span><span class="ss">(</span><span class="nv">device</span>.<span class="nv">eq</span>.<span class="s1">&#39;</span><span class="s">x11</span><span class="s1">&#39;</span><span class="ss">)</span><span class="k">then</span>
      <span class="k">call</span> <span class="nl">prefposition</span><span class="ss">(</span><span class="mi">0</span>,<span class="mi">0</span><span class="ss">)</span>
      <span class="k">call</span> <span class="nl">prefsize</span><span class="ss">(</span><span class="nv">ixsize</span>,<span class="nv">iysize</span><span class="ss">)</span>
   <span class="k">else</span>
      <span class="k">call</span> <span class="nl">prefsize</span><span class="ss">(</span><span class="nv">ixsize</span>,<span class="nv">iysize</span><span class="ss">)</span>
      <span class="o">!!</span><span class="k">call</span> <span class="nl">voutput</span><span class="ss">(</span><span class="nv">str</span><span class="ss">(</span><span class="nv">filename</span>,<span class="s1">&#39;</span><span class="s">_</span><span class="s1">&#39;</span>,<span class="nv">int</span><span class="ss">(</span><span class="nv">a</span><span class="ss">)</span>,<span class="s1">&#39;</span><span class="s">x</span><span class="s1">&#39;</span>,<span class="nv">int</span><span class="ss">(</span><span class="nv">b</span><span class="ss">)</span>,<span class="s1">&#39;</span><span class="s">.</span><span class="s1">&#39;</span>,<span class="nv">device</span>,<span class="nv">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="ss">))</span>
   <span class="k">endif</span>
   <span class="k">call</span> <span class="nl">vinit</span><span class="ss">(</span><span class="nv">device</span><span class="ss">)</span>
   <span class="k">call</span> <span class="nl">vsetflush</span><span class="ss">(</span>.<span class="nv">false</span>.<span class="ss">)</span>
   <span class="k">call</span> <span class="nl">vflush</span><span class="ss">()</span>
   <span class="k">call</span> <span class="nl">linewidth</span><span class="ss">(</span><span class="nv">w</span><span class="ss">)</span>

<span class="o">!</span>     <span class="nv">fill</span> <span class="nv">some</span> <span class="nv">arrays</span> <span class="nv">with</span> <span class="nv">data</span> <span class="nv">we</span> <span class="nv">can</span> <span class="nv">plot</span>
   <span class="k">DO</span> <span class="nv">i20</span><span class="o">=</span><span class="mi">1</span>,<span class="mi">25</span>
      <span class="nv">X</span><span class="ss">(</span><span class="nv">i20</span><span class="ss">)</span><span class="o">=</span><span class="nv">i20</span>
      <span class="nv">Y</span><span class="ss">(</span><span class="nv">i20</span>,<span class="mi">1</span><span class="ss">)</span><span class="o">=</span><span class="nv">i20</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">5</span>.<span class="mi">0</span>
      <span class="nv">Y</span><span class="ss">(</span><span class="nv">i20</span>,<span class="mi">2</span><span class="ss">)</span><span class="o">=</span><span class="nv">i20</span><span class="o">*</span><span class="mi">20</span>.<span class="mi">0</span>
      <span class="nv">Y</span><span class="ss">(</span><span class="nv">i20</span>,<span class="mi">3</span><span class="ss">)</span><span class="o">=</span><span class="ss">(</span><span class="o">-</span><span class="mi">3</span>.<span class="mi">0</span><span class="ss">)</span><span class="o">*</span><span class="ss">(</span><span class="nv">i20</span><span class="o">/</span><span class="mi">4</span>.<span class="mi">0</span><span class="ss">)</span><span class="o">**</span><span class="mi">3</span>
   <span class="nv">enddo</span>

   <span class="nv">f</span><span class="o">=</span><span class="mi">0</span>.<span class="mi">0</span> <span class="o">!</span>     <span class="nv">zero</span> <span class="nv">out</span> <span class="nv">option</span> <span class="nv">array</span>
<span class="o">!</span>     <span class="nv">set</span> <span class="nv">up</span> <span class="nv">color</span> <span class="nv">and</span> <span class="nv">linetype</span> <span class="nv">in</span> <span class="nv">option</span> <span class="nv">array</span>
   <span class="k">do</span> <span class="nv">i70</span><span class="o">=</span><span class="mi">55</span>,<span class="nv">nf</span>,<span class="mi">2</span>
      <span class="nv">f</span><span class="ss">(</span><span class="nv">i70</span><span class="ss">)</span><span class="o">=</span><span class="nv">mod</span><span class="ss">(</span><span class="nv">i70</span>,<span class="mi">7</span><span class="ss">)</span>
      <span class="nv">f</span><span class="ss">(</span><span class="nv">i70</span><span class="o">-</span><span class="mi">1</span><span class="ss">)</span><span class="o">=</span><span class="nv">mod</span><span class="ss">(</span><span class="nv">i70</span>,<span class="mi">7</span><span class="ss">)</span>
   <span class="nv">enddo</span>
   <span class="nv">f</span><span class="ss">(</span><span class="mi">52</span><span class="ss">)</span><span class="o">=</span><span class="mi">1</span>
   <span class="nv">f</span><span class="ss">(</span><span class="mi">53</span><span class="ss">)</span><span class="o">=</span><span class="mi">1</span>

   <span class="nv">ndp</span><span class="o">=</span><span class="nv">numpts</span><span class="o">!</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">data</span> <span class="nv">points</span> <span class="nv">per</span> <span class="nv">line</span>
   <span class="nv">ndl</span><span class="o">=</span><span class="mi">3</span>     <span class="o">!</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">data</span> <span class="nv">lines</span>
   <span class="o">!</span><span class="nv">c</span>        <span class="o">!</span> <span class="nv">array</span> <span class="nv">of</span> <span class="nv">strings</span> <span class="nv">dimensioned</span> <span class="nv">c</span><span class="ss">(</span><span class="mi">3</span><span class="o">+</span><span class="nv">numpts</span><span class="ss">)</span>
   <span class="nv">c</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span><span class="o">=</span><span class="s1">&#39;</span><span class="s">X-AXIS</span><span class="s1">&#39;</span>  <span class="o">!</span>  <span class="nv">c</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span> : <span class="nv">x</span> <span class="nv">axis</span> <span class="nv">title</span>
   <span class="nv">c</span><span class="ss">(</span><span class="mi">2</span><span class="ss">)</span><span class="o">=</span><span class="s1">&#39;</span><span class="s">Y-AXIS</span><span class="s1">&#39;</span>  <span class="o">!</span>  <span class="nv">c</span><span class="ss">(</span><span class="mi">2</span><span class="ss">)</span> : <span class="nv">y</span> <span class="nv">axis</span> <span class="nv">title</span>
   <span class="nv">c</span><span class="ss">(</span><span class="mi">3</span><span class="ss">)</span><span class="o">=</span><span class="s1">&#39;</span><span class="s">TITLE</span><span class="s1">&#39;</span>  <span class="o">!</span>  <span class="nv">c</span><span class="ss">(</span><span class="mi">3</span><span class="ss">)</span> : <span class="nv">top</span> <span class="nv">title</span>
   <span class="nv">c</span><span class="ss">(</span><span class="mi">4</span><span class="ss">)</span><span class="o">=</span><span class="s1">&#39;</span><span class="s">LABEL 1</span><span class="s1">&#39;</span>  <span class="o">!</span>  <span class="nv">c</span><span class="ss">(</span><span class="nv">n</span><span class="ss">)</span> : <span class="nv">line</span> <span class="nv">N</span><span class="o">-</span><span class="mi">3</span> <span class="nv">legend</span> <span class="ss">(</span><span class="nv">optionally</span> <span class="nv">used</span><span class="ss">)</span>
   <span class="nv">c</span><span class="ss">(</span><span class="mi">5</span><span class="ss">)</span><span class="o">=</span><span class="s1">&#39;</span><span class="s">LABEL 2</span><span class="s1">&#39;</span>  <span class="o">!</span>  <span class="nv">c</span><span class="ss">(</span><span class="nv">n</span><span class="ss">)</span> : <span class="nv">line</span> <span class="nv">N</span><span class="o">-</span><span class="mi">3</span> <span class="nv">legend</span> <span class="ss">(</span><span class="nv">optionally</span> <span class="nv">used</span><span class="ss">)</span>
   <span class="nv">c</span><span class="ss">(</span><span class="mi">6</span><span class="ss">)</span><span class="o">=</span><span class="s1">&#39;</span><span class="s">LABEL 3</span><span class="s1">&#39;</span>  <span class="o">!</span>  <span class="nv">c</span><span class="ss">(</span><span class="nv">n</span><span class="ss">)</span> : <span class="nv">line</span> <span class="nv">N</span><span class="o">-</span><span class="mi">3</span> <span class="nv">legend</span> <span class="ss">(</span><span class="nv">optionally</span> <span class="nv">used</span><span class="ss">)</span>
   <span class="o">!</span><span class="nv">nc</span>       <span class="o">!</span> <span class="nv">array</span> <span class="nv">of</span> <span class="nv">string</span> <span class="nv">lengths</span> <span class="nv">in</span> <span class="nv">c</span><span class="ss">()</span> <span class="nv">dimensioned</span> <span class="nv">nc</span><span class="ss">(</span><span class="mi">3</span><span class="o">+</span><span class="nv">numpts</span><span class="ss">)</span>
   <span class="k">do</span> <span class="nv">i60</span><span class="o">=</span><span class="mi">1</span>,<span class="mi">6</span>
      <span class="nv">nc</span><span class="ss">(</span><span class="nv">i60</span><span class="ss">)</span><span class="o">=</span><span class="nv">len_trim</span><span class="ss">(</span><span class="nv">c</span><span class="ss">(</span><span class="nv">i60</span><span class="ss">))</span>
   <span class="nv">enddo</span>
   <span class="o">!</span><span class="nv">f</span><span class="ss">(</span><span class="mi">39</span><span class="ss">)</span><span class="o">=</span> <span class="mi">0</span>.<span class="mi">25</span>
   <span class="o">!</span><span class="nv">f</span><span class="ss">(</span><span class="mi">40</span><span class="ss">)</span><span class="o">=</span> <span class="mi">0</span>.<span class="mi">25</span>
   <span class="o">!</span><span class="nv">f</span><span class="ss">(</span><span class="mi">42</span><span class="ss">)</span><span class="o">=</span> <span class="mi">3</span>.<span class="mi">00</span>
   <span class="o">!</span><span class="nv">f</span><span class="ss">(</span><span class="mi">43</span><span class="ss">)</span><span class="o">=-</span><span class="mi">1</span>.<span class="mi">00</span>
<span class="o">!</span>  <span class="nv">initialize</span> <span class="nv">graphics</span>
   <span class="k">call</span> <span class="nl">graph_init</span><span class="ss">(</span><span class="mi">12</span>.<span class="mi">0</span>,<span class="mi">9</span>.<span class="mi">0</span>, <span class="mi">1</span>.<span class="mi">00</span>,<span class="mi">1</span>.<span class="mi">00</span>, <span class="mi">1</span>.<span class="mi">0</span><span class="ss">)</span>
   <span class="nv">INFINITE</span>: <span class="k">do</span>
      <span class="k">CALL</span> <span class="nl">graph</span><span class="ss">(</span><span class="nv">X</span>,<span class="nv">Y</span>,<span class="nv">NDP</span>,<span class="nv">NDL</span>,<span class="nv">F</span>,<span class="nv">C</span>,<span class="nv">NC</span><span class="ss">)</span>
      <span class="k">call</span> <span class="nl">vflush</span><span class="ss">()</span>
<span class="mi">888</span>   <span class="k">continue</span>
      <span class="nv">write</span><span class="ss">(</span><span class="o">*</span>,<span class="o">*</span><span class="ss">)</span><span class="s1">&#39;</span><span class="s">Enter index and value for graph(3f) option array:</span><span class="s1">&#39;</span>
      <span class="nv">read</span><span class="ss">(</span><span class="o">*</span>,<span class="o">*</span>,<span class="k">end</span><span class="o">=</span><span class="mi">999</span>,<span class="nv">err</span><span class="o">=</span><span class="mi">888</span><span class="ss">)</span><span class="nv">indx</span>,<span class="nv">value</span>
      <span class="k">if</span><span class="ss">(</span><span class="nv">indx</span>.<span class="nv">lt</span>.<span class="mi">1</span><span class="ss">)</span><span class="k">then</span>
         <span class="k">exit</span> <span class="nv">INFINITE</span>
      <span class="k">elseif</span><span class="ss">(</span><span class="nv">indx</span>.<span class="nv">gt</span>.<span class="nv">nf</span><span class="ss">)</span><span class="k">then</span>
         <span class="k">goto</span> <span class="nl">888</span>
      <span class="k">else</span>
         <span class="nv">f</span><span class="ss">(</span><span class="nv">indx</span><span class="ss">)</span><span class="o">=</span><span class="nv">value</span>
         <span class="nv">write</span><span class="ss">(</span><span class="o">*</span>,<span class="o">*</span><span class="ss">)</span><span class="s1">&#39;</span><span class="s">indx </span><span class="s1">&#39;</span>,<span class="nv">indx</span>,<span class="s1">&#39;</span><span class="s"> now </span><span class="s1">&#39;</span>,<span class="nv">value</span>
      <span class="k">endif</span>
      <span class="k">call</span> <span class="nl">vflush</span><span class="ss">()</span>              <span class="o">!</span> <span class="nv">flush</span> <span class="nv">graphics</span> <span class="nv">buffers</span>
      <span class="k">call</span> <span class="nl">color</span><span class="ss">(</span><span class="mi">7</span><span class="ss">)</span>
      <span class="k">call</span> <span class="nl">clear</span><span class="ss">()</span>
      <span class="k">call</span> <span class="nl">color</span><span class="ss">(</span><span class="mi">0</span><span class="ss">)</span>
      <span class="k">call</span> <span class="nl">vflush</span><span class="ss">()</span>              <span class="o">!</span> <span class="nv">flush</span> <span class="nv">graphics</span> <span class="nv">buffers</span>
   <span class="nv">enddo</span> <span class="nv">INFINITE</span>
<span class="mi">999</span> <span class="k">continue</span>
   <span class="k">call</span> <span class="nl">vflush</span><span class="ss">()</span>              <span class="o">!</span> <span class="nv">flush</span> <span class="nv">graphics</span> <span class="nv">buffers</span>
   <span class="k">call</span> <span class="nl">vexit</span><span class="ss">()</span>               <span class="o">!</span> <span class="nv">close</span> <span class="nv">up</span> <span class="nv">plot</span> <span class="nv">package</span>
   <span class="nv">stop</span>
<span class="k">end</span> <span class="nv">program</span> <span class="nv">demo_graph</span>
</code></pre></div>

<h2 id="author">AUTHOR</h2>
<div class="codehilite"><pre><span></span><code><span class="nv">Based</span> <span class="nv">on</span> [<span class="nv">LONGLIB93</span>.<span class="nv">SOURCES</span>.<span class="nv">FORTRAN</span>.<span class="nv">MASTER</span>]<span class="nv">graph</span>.<span class="k">FOR</span>
</code></pre></div>

<p>!     WRITTEN:  Version 1.0 SEPT. 1987 - DGL
                 Version 2.0 20-JAN-1994 17:13:12.80
                 Version 3.0 Wed Jun 12 10:34:11 MDT 1996</p>

    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
<th>Intent</th><th>Optional</th>        <th>Attributes</th>
        <th></th>
        <th>Name</th>
        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-x~2"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(ndp,ndl)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-y~2"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>y</strong>(ndp,ndl)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ndp"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ndp</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ndl~2"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ndl</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-f"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>f</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-c"></span>
              character(len=*)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>C</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nc"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nc</strong>(*)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
        <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/graph.html#src">graph</a>
      </div>
    </div>


    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">SUBROUTINE </span><span class="n">graph</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">NDP</span><span class="p">,</span><span class="n">NDL</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">NC</span><span class="p">)</span><span class="w"></span>

<span class="c">! ident_1=&quot;@(#) M_graph graph(3f) routine for plotting lines&quot;</span>

<span class="c">!</span>
<span class="c">!     X  (R) X input array dimensioned X(NDP,NDL)</span>
<span class="c">!            NOTE: depending on options selected, X</span>
<span class="c">!            actually may be dimensioned X(NDP)</span>
<span class="c">!     Y  (R) Y Input array dimensioned Y(NDP,NDL)</span>
<span class="c">!     NDP   (I) number of points per line dimension</span>
<span class="c">!     NDL   (I) number of lines dimension</span>
<span class="c">!     F  (R) options array (described below)</span>
<span class="c">!     C  (C) titles array</span>
<span class="c">!             C(1) X axis title</span>
<span class="c">!             C(2) Y axis title</span>
<span class="c">!             C(3) chart title</span>
<span class="c">!             C(4) legend text for line 1 (if legend enabled)</span>
<span class="c">!             C(5) legend text for line 2 (if legend enabled)</span>
<span class="c">!             ...   ...</span>
<span class="c">!     NC (I) number of characters in title array</span>
<span class="c">!            NC(1) number of characters in C(1)</span>
<span class="c">!            NC(2) number of characters in C(2)</span>
<span class="c">!            ...    ...</span>
<span class="c">!            ETC.  NOTE: if NC(I) is zero C(I) is not plotted</span>
<span class="c">!</span>
<span class="c">!     the elements of F are interpreted according to the following:</span>
<span class="c">!     default values are shown in square brackets</span>
<span class="c">!</span>
<span class="c">!   INDEX OF F VALUE    ACTION</span>
<span class="c">!  ____________ _____   ___________________</span>
<span class="c">!     1  0&lt;.&lt;=NDP NUMBER OF POINTS PLOTTED [NDP]</span>
<span class="c">!     2  0&lt;.&lt;=NDL NUMBER OF LINES PLOTTED [NL]</span>
<span class="c">!     3  -1/0/1   X AUTO SCALING: 0=AUTO,SMOOTH; 1=AUTO,NOSMOOTH; -1=USER</span>
<span class="c">!     4  XMIN     USER SUPPLIED SCALE VALUE (USED IF F(3)&lt;0)</span>
<span class="c">!     5  XMAX     USER SUPPLIED SCALE VALUE (USED IF F(3)&lt;0)</span>
<span class="c">!     6  -1/0/1   Y AUTO SCALING: 0=AUTO,SMOOTH; 1=AUTO,NOSMOOTH; -1=USER</span>
<span class="c">!     7  YMIN     USER SUPPLIED SCALE VALUE (USED IF F(6)&lt;0)</span>
<span class="c">!     8  YMAX     USER SUPPLIED SCALE VALUE (USED IF F(6)&lt;0)</span>
<span class="c">!     9  0/1      USE X VALUES WITH Y VALUES: 0=ONLY FIRST LINE OF</span>
<span class="c">!                 X DATA USED FOR ALL Y LINES; 1=LINES OF X/Y USED</span>
<span class="c">!     10 0/1      CONNECT PLOTTED POINTS: 0=YES; 1=NO</span>
<span class="c">!     11 &gt;=0      SYMBOL PLOTTED EVERY ()TH POINT: 0=NO SYMBOLS</span>
<span class="c">!     12 &gt;=0      SYMBOL SIZE [0.1]: 0=USE DEFAULT</span>
<span class="c">!     13 &gt;=0      SYMBOL NUMBER FOR FIRST DATA LINE</span>
<span class="c">!     14 -8&lt;.&lt;8   SHOW ERROR BARS: 0=NO ERROR BARS</span>
<span class="c">!                 WHEN NON-ZERO, CHANGES INTERPRETATION OF LINES</span>
<span class="c">!                 POINTS EVERY THIRD LINE ARE PLOTTED.  RELATIVE</span>
<span class="c">!                 ERROR (UPPER,LOWER) ARE THE FOLLOWING TWO LINES.</span>
<span class="c">!                 PLOTTED RELATIVE ERROR COMPUTED AS SUM OF FIRST</span>
<span class="c">!                 LINE PLUS SECOND/THIRD.</span>
<span class="c">!          &lt;0     AN X IS MADE AT THE CENTER POINT</span>
<span class="c">!</span>
<span class="c">!        ABS(.)  TYPE OF ERROR BAR</span>
<span class="c">!        ------  ---------------------------------------------------</span>
<span class="c">!          1   LINE CONNECTING 2ND/3RD RELATIVE ERRORS</span>
<span class="c">!          2   1+HORIZONTAL BARS OF WIDTH EBAR AT 2ND/3RD REL ERR</span>
<span class="c">!          3   1+VERTICAL BARS OF WIDTH EBAR AT 2ND/3RD REL ERR</span>
<span class="c">!          4   2 LINES SPACED EBAR/2+HORIZONTAL BARS WIDTH=EBAR</span>
<span class="c">!          5   2 LINES SPACED EBAR/2+VERTICAL BARS WIDTH=EBAR</span>
<span class="c">!          6   VERTICAL RECTANGLE FROM 2ND/3RD WITH WIDTH=EBAR</span>
<span class="c">!          7     RECTANGLE WITH CORNER AT 2ND/3RD REL ERROR</span>
<span class="c">!</span>
<span class="c">!     16 &gt;=0   ERROR BAR SIZE [0.1]: 0=DEFAULT USED</span>
<span class="c">!     17 0/1   VERTICAL DRAWN LINE FROM POINT TO REFERENCE VALUE:</span>
<span class="c">!           0=NO; 1=YES</span>
<span class="c">!     18    REFERENCE VALUE</span>
<span class="c">!     19 -1/0/1   X AXIS TYPE: 0=LINEAR; 1=LOG AXIS, -1=NO AXIS</span>
<span class="c">!     20 -1/0/1   Y AXIS TYPE: 0=LINEAR; 1=LOG AXIS, -1=NO AXIS</span>
<span class="c">!     21 &gt;=0      X AXIS LENGTH [7.0]: 0=DEFAULT USED</span>
<span class="c">!     22 &gt;=0      Y AXIS LENGTH [5.0]: 0=DEFAULT USED</span>
<span class="c">!     23 &gt;=0      X AXIS TICK PATTERN (SEE axisc_) [7.00]: 0=DEFAULT</span>
<span class="c">!     24 &gt;=0      Y AXIS TICK PATTERN (SEE axisc_) [5.00]: 0=DEFAULT</span>
<span class="c">!     25 0/1      X AXIS TITLE SIDE OF AXIS: 0=BELOW; 1=ABOVE</span>
<span class="c">!     26 0/1      Y AXIS TITLE SIDE OF AXIS: 0=LEFT; 1=RIGHT</span>
<span class="c">!     27 0/1      X AXIS AUTO EXPONENT ENABLE: 0=ENABLE; 1=DISABLE</span>
<span class="c">!     28 0/1      Y AXIS AUTO EXPONENT ENABLE: 0=ENABLE; 1=DISABLE</span>
<span class="c">!     29 0/1      X AXIS TICK SIDE: 0=BELOW; 1=ABOVE</span>
<span class="c">!     30 0/1      Y AXIS TICK SIDE: 0=LEFT; 1=RIGHT</span>
<span class="c">!     31 0/1      X AXIS NUMBERS ORIENTATION: 0=HORIZONTAL; 1=VERTICAL</span>
<span class="c">!     32 0/1      Y AXIS NUMBERS ORIENTATION: 0=VERTICAL; 1=HORIZONTAL</span>
<span class="c">!     33 0/1      X AXIS NUMBERS/TITLE SHWON: 0=SHOWN; 1=NOT SHOWN</span>
<span class="c">!     34 0/1      Y AXIS NUMBERS/TITLE SHWON: 0=SHOWN; 1=NOT SHOWN</span>
<span class="c">!     35 0/1      TAKE LOG10(ABS(X VALUES)+1.E-34): 0=NO; 1=YES</span>
<span class="c">!     36 0/1      TAKE LOG10(ABS(Y VALUES)+1.E-34): 0=NO; 1=YES</span>
<span class="c">!     37 -1/0/1   ADD MIRROR X AXIS: 0=NO; 1=WITH LABELS; -1:W/O LABELS</span>
<span class="c">!     38 -1/0/1   ADD MIRROR Y AXIS: 0=NO; 1=WITH LABELS; -1:W/O LABELS</span>
<span class="c">!     39 &gt;=0      X AXIS LABEL SIZE [0.15]: 0=USE DEFAULT</span>
<span class="c">!     40 &gt;=0      Y AXIS LABEL SIZE [0.15]: 0=USE DEFAULT</span>
<span class="c">!     41 &gt;=0      TOP TITLE CHARACTER SIZE [0.18]: 0=USE DEFAULT</span>
<span class="c">!     42 0/1/2/3  GRID OPTION: 0=NO GRID; 1=SOLID; 2=DOTTED; 3=TICKED</span>
<span class="c">!     43 -1/0/1   LINE/SYMBOL LEGEND: 0=NO LEGEND; 1=AUTO PLACE; -1=USER</span>
<span class="c">!     44 X        USER SPECIFIED LOWER-LEFT CORNER OF LEGEND</span>
<span class="c">!     45 Y        USER SPECIFIED LOWER-LEFT CORNER OF LEGEND</span>
<span class="c">!     46 0/1      SHOW PLOT SYMBOL WITH LEGEND: 0=NO; 1=YES</span>
<span class="c">!     47 0/1      SHOW LINE SEGMENT ON LEGEND: 0=NO; 1=YES</span>
<span class="c">!     48 &gt;=0      LEGEND CHARACTER HEIGHT [0.12]: 0=USE DEFAULT</span>
<span class="c">!     49 &gt;=0      LEGEND SEGMENT LENGTH [0.5]: 0=USE DEFAULT</span>
<span class="c">!     50 -1/0/1   TOP TITLE JUSTIFY: 0=CENTER; -1:LEFT; 1:RIGHT</span>
<span class="c">!     51 0/1      PLOT HORIZONTAL REFERENCE LINE: 0=NO; 1=YES</span>
<span class="c">!     52 0/1      USE LINE TYPE ARRAY VALUES: 0=NO; 1=YES</span>
<span class="c">!     53 0/1      USE COLOR ARRAY VALUES: 0=NO; 1=YES</span>
<span class="c">!     54 &gt;=0      COLOR INDEX 1: 0=COLOR 1 USED</span>
<span class="c">!     55 &gt;=0      LINETYPE INDEX 1</span>
<span class="c">!     56 &gt;=0      COLOR INDEX 2: 0=COLOR 1 USED</span>
<span class="c">!     57 &gt;=0      LINETYPE INDEX 2</span>
<span class="c">!     ...         ... ETC ...</span>
<span class="c">!</span>
<span class="c">!     INDEX    COLOR USAGE LINETYPE USAGE</span>
<span class="c">!     -------     ------------    --------------</span>
<span class="c">!       1           X AXIS  X AXIS</span>
<span class="c">!       2         X AXIS NUMBERS Y AXIS</span>
<span class="c">!       3         X AXIS TITLE TITLE</span>
<span class="c">!       4         X AXIS EXPONENT LEGEND TITLES</span>
<span class="c">!       5      Y AXIS    ZERO REF LINETYPE</span>
<span class="c">!       6         Y AXIS NUMBERS ERROR BAR LINETYPES</span>
<span class="c">!       7         Y AXIS TITLE LINE 1 LINETYPE</span>
<span class="c">!       8         Y AXIS EXPONENT     ETC.</span>
<span class="c">!       9           TITLE    ...</span>
<span class="c">!      10      LEGEND TITLES   ...</span>
<span class="c">!      11      ZERO REF LINE   ...</span>
<span class="c">!      12      GRID COLOR   ...</span>
<span class="c">!      13      LINE 1 COLOR   ...</span>
<span class="c">!     ...      ... ETC. ...      ...</span>
<span class="c">!</span>
<span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">IC</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">SMO</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">csleg</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">dx</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">dy</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">ebar</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">fx</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">fy</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">glen</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">icc</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">icoff</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">iloff</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">ipen</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">isym</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jcol</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jconn</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jebar</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jgrid</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jlegli</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jlegnd</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jlegsy</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jline</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jsym</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jsymst</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jszref</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jtcntr</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jvline</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jxauto</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jxexpsc</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jxlgax</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jxlog</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jxnum</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jxnums</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jxrax</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jxticks</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jxtitle</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jxuse</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jyauto</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jyexpsc</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jylgax</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jylog</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jynum</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jynums</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jyrax</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jyticks</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">jytitle</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">kebar</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">ksym</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">na</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nbar</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nc</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">ndl</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">ndp</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">ng</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nl</span><span class="w"></span>
<span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">np</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">symsiz</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">tcs</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">ndp</span><span class="p">,</span><span class="n">ndl</span><span class="p">)</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">x1</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">x2</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">x3</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">xcs</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">xleg</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">xlen</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">xm</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">xtick</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">xx</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">xy</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">ndp</span><span class="p">,</span><span class="n">ndl</span><span class="p">)</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">y1</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">y2</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">y3</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">ycs</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">yleg</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">ylen</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">ym</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">ytick</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">yx</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">zref</span><span class="w"></span>
<span class="kt">real</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">zval</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     ESTABLISH DEFAULTS</span>
<span class="c">!</span>
<span class="w">   </span><span class="n">np</span><span class="o">=</span><span class="n">ndp</span><span class="w">            </span><span class="c">! NUMBER OF POINTS/LINE</span>
<span class="w">   </span><span class="n">nl</span><span class="o">=</span><span class="n">ndl</span><span class="w">            </span><span class="c">! NUMBER OF LINES</span>
<span class="w">   </span><span class="n">xm</span><span class="o">=</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="c">! MIN X VALUE</span>
<span class="w">   </span><span class="n">xx</span><span class="o">=</span><span class="n">xm</span><span class="w">             </span><span class="c">! MAX X VALUE</span>
<span class="w">   </span><span class="n">ym</span><span class="o">=</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="c">! MIN Y VALUE</span>
<span class="w">   </span><span class="n">yx</span><span class="o">=</span><span class="n">ym</span><span class="w">             </span><span class="c">! MAX Y VALUE</span>
<span class="w">   </span><span class="n">fx</span><span class="o">=</span><span class="mf">5.01</span><span class="w">           </span><span class="c">! X AXIS NUMBER FORMAT</span>
<span class="w">   </span><span class="n">fy</span><span class="o">=</span><span class="mf">5.01</span><span class="w">           </span><span class="c">! Y AXIS NUMBER FORMAT</span>
<span class="w">   </span><span class="n">xlen</span><span class="o">=</span><span class="mf">7.0</span><span class="w">          </span><span class="c">! X AXIS LENGTH</span>
<span class="w">   </span><span class="n">ylen</span><span class="o">=</span><span class="mf">5.0</span><span class="w">          </span><span class="c">! Y AXIS LENGTH</span>
<span class="w">   </span><span class="n">xtick</span><span class="o">=</span><span class="mf">7.0</span><span class="w">         </span><span class="c">! X AXIS TICK PATTERN</span>
<span class="w">   </span><span class="n">ytick</span><span class="o">=</span><span class="mf">6.0</span><span class="w">         </span><span class="c">! Y AXIS TICK PATTERN</span>
<span class="w">   </span><span class="n">xcs</span><span class="o">=</span><span class="mf">0.15</span><span class="w">          </span><span class="c">! X AXIS TITLE SIZE</span>
<span class="w">   </span><span class="n">ycs</span><span class="o">=</span><span class="mf">0.15</span><span class="w">          </span><span class="c">! Y AXIS TITLE SIZE</span>
<span class="w">   </span><span class="n">tcs</span><span class="o">=</span><span class="mf">0.18</span><span class="w">          </span><span class="c">! OVERALL TITLE SIZE</span>
<span class="w">   </span><span class="n">ebar</span><span class="o">=</span><span class="mf">0.1</span><span class="w">          </span><span class="c">! ERROR BAR SIZE</span>
<span class="w">   </span><span class="n">symsiz</span><span class="o">=</span><span class="mf">0.1</span><span class="w">        </span><span class="c">! SYMBOL SIZE</span>
<span class="w">   </span><span class="n">csleg</span><span class="o">=</span><span class="mf">0.12</span><span class="w">        </span><span class="c">! LEGEND CHARACTER SIZE</span>
<span class="w">   </span><span class="n">glen</span><span class="o">=</span><span class="mf">0.5</span><span class="w">          </span><span class="c">! LEGEND LINE LENGTH</span>
<span class="w">   </span><span class="n">xleg</span><span class="o">=</span><span class="n">xlen</span><span class="o">+</span><span class="mf">0.3</span><span class="w">     </span><span class="c">! DEFAULT LEGEND LOCATION</span>
<span class="w">   </span><span class="n">yleg</span><span class="o">=</span><span class="mf">0.5</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     READ OPTIONS ARRAY</span>
<span class="c">!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">np</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c">! NUMBER OF POINT/LINE</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">ndp</span><span class="p">)</span><span class="w"> </span><span class="n">np</span><span class="o">=</span><span class="n">ndp</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">nl</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c">! NUMBER OF LINES</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nl</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">ndl</span><span class="p">)</span><span class="w"> </span><span class="n">nl</span><span class="o">=</span><span class="n">ndl</span><span class="w"></span>
<span class="w">   </span><span class="n">jxauto</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">         </span><span class="c">! AUTO SCALE X, 0=YES/SMOOTH,-1=NO/USER</span>
<span class="c">!                   1=YES/NO SMOOTH</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxauto</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! INPUT X AXIS SCALE FACTORS</span>
<span class="w">      </span><span class="n">xm</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">          </span><span class="c">! MIN X (OTHERWISE RETURNED)</span>
<span class="w">      </span><span class="n">xx</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">          </span><span class="c">! MAX X</span>
<span class="w">   </span><span class="k">endif</span>
<span class="k">   </span><span class="n">jyauto</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">         </span><span class="c">! AUTO SCALE Y, 0=YES/SMOOTH,-1=NO/USER</span>
<span class="c">!                   1=YES/NO SMOOTH</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jyauto</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! INPUT Y AXIS SCALE FACTORS</span>
<span class="w">      </span><span class="n">ym</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w">          </span><span class="c">! MIN Y (OTHERWISE RETURNED)</span>
<span class="w">      </span><span class="n">yx</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w">          </span><span class="c">! MAX Y</span>
<span class="w">   </span><span class="k">endif</span>
<span class="k">   </span><span class="n">jxuse</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="w">     </span><span class="c">! USE X LINES WITH Y LINES,0=NO,1=YES</span>
<span class="w">   </span><span class="n">jconn</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w">    </span><span class="c">! CONNECT POINTS WITH LINES,0=YES,1=NO</span>
<span class="w">   </span><span class="n">jsym</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="w">     </span><span class="c">! PLOT SYMBOL EVERY JSYM PT,0=NO SYMS</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">12</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">symsiz</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"> </span><span class="c">! SYMBOL SIZE</span>
<span class="w">   </span><span class="n">jsymst</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="w">   </span><span class="c">! STARTING PLOT SYMBOL NUMBER</span>
<span class="w">   </span><span class="n">jebar</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="w">         </span><span class="c">! TYPE OF ERROR BAR,0=NOT USED</span>
<span class="c">!</span>
<span class="c">!        |JEBAR|  ERROR BAR (CLINE IS LINE CONNECT 2ND/3RD REL. ERR)</span>
<span class="c">!        -------  ---------------------------------------------------</span>
<span class="c">!          1     CLINE</span>
<span class="c">!          2     CLINE+HORIZONTAL BARS WIDTH=EBAR</span>
<span class="c">!          3     CLINE+VERTICAL BARS WIDTH=EBAR</span>
<span class="c">!          4     DOUBLE CLINE+HORIZONTAL BARS WIDTH=EBAR</span>
<span class="c">!          5     DOUBLE CLINE+VERTICAL BARS WIDTH=EBAR</span>
<span class="c">!          6     VERTICAL RECTANGLE WIDTH=EBAR</span>
<span class="c">!          7       RECTANGLE DEFINED BY 2ND/3RD REL ERROR</span>
<span class="c">!</span>
<span class="c">!        NOTE: IF JBAR &lt; 0 AN X (SIZE EBAR) IS USED TO MARK 1ST LINE</span>
<span class="c">!</span>
<span class="w">   </span><span class="n">kebar</span><span class="o">=</span><span class="nb">iabs</span><span class="p">(</span><span class="n">jebar</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">nbar</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jebar</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">nbar</span><span class="o">=</span><span class="mi">3</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">ebar</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="w">  </span><span class="c">! ERROR BAR SIZE</span>
<span class="c">!                   1ST LINE DEFINES CENTER</span>
<span class="c">!                   2ND IS LOWER REL. ERROR</span>
<span class="c">!                   3RD IS UPPER REL. ERROR</span>
<span class="w">   </span><span class="n">jvline</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="w">                  </span><span class="c">! VERTICAL LINE TO ZVAL,0=NO,1=YES</span>
<span class="w">   </span><span class="n">zval</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="w">                    </span><span class="c">! ZERO REFERENCE VALUE</span>
<span class="w">   </span><span class="n">jxlgax</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span><span class="w">                  </span><span class="c">! X AXIS, LINEAR=0/LOG=1/NONE=-1</span>
<span class="w">   </span><span class="n">jylgax</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w">                  </span><span class="c">! Y AXIS, LINEAR=0/LOG=1/NONE=-1</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">21</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">xlen</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span><span class="w">  </span><span class="c">! X AXIS LENGTH</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">22</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">ylen</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span><span class="w">  </span><span class="c">! Y AXIS LENGTH</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">23</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">xtick</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="w"> </span><span class="c">! X AXIS TICK PATTERN</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">24</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">ytick</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="w"> </span><span class="c">! Y AXIS TICK PATTERN</span>
<span class="w">   </span><span class="n">jxtitle</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span><span class="w">            </span><span class="c">! X AXIS TITLE SIDE,0=CW,1=CCW</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxtitle</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">jxtitle</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="w">   </span><span class="k">else</span>
<span class="k">      </span><span class="n">jxtitle</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span>
<span class="k">   </span><span class="n">jytitle</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span><span class="w">            </span><span class="c">! Y AXIS TITLE SIDE,0=CCW,1=CW</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jytitle</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">jytitle</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">   </span><span class="k">else</span>
<span class="k">      </span><span class="n">jytitle</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span>
<span class="k">   </span><span class="n">jxexpsc</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">27</span><span class="p">))</span><span class="w">            </span><span class="c">! X AXIS ENABLE AUTO EXPONENT,0=YES,1=NO</span>
<span class="w">   </span><span class="n">jyexpsc</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="w">            </span><span class="c">! Y AXIS ENABLE AUTO EXPONENT,0=YES,1=NO</span>
<span class="w">   </span><span class="n">jxticks</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span><span class="w">            </span><span class="c">! X AXIS TICKS TITLE SIDE,0=YES,1=NO</span>
<span class="w">   </span><span class="n">jyticks</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span><span class="w">            </span><span class="c">! Y AXIS TICKS TITLE SIDE,0=YES,1=NO</span>
<span class="w">   </span><span class="n">jxnums</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span><span class="w">             </span><span class="c">! X AXIS NUMS PARA AXIS, 0=YES,1=NO</span>
<span class="w">   </span><span class="n">jynums</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="w">             </span><span class="c">! Y AXIS NUMS PARA AXIS, 0=YES,1=NO</span>
<span class="w">   </span><span class="n">jxnum</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">33</span><span class="p">))</span><span class="w">              </span><span class="c">! X AXIS NUMS SHOWN, 0=YES,1=NO</span>
<span class="w">   </span><span class="n">jynum</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">34</span><span class="p">))</span><span class="w">              </span><span class="c">! Y AXIS NUMS SHOWN, 0=YES,1=NO</span>
<span class="w">   </span><span class="n">jxlog</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span><span class="w">              </span><span class="c">! TAKE LOG OF X VALUES, 0=NO,1=YES</span>
<span class="w">   </span><span class="n">jylog</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span><span class="w">              </span><span class="c">! TAKE LOG OF Y VALUES, 0=NO,1=YES</span>
<span class="w">   </span><span class="n">jxrax</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="w">                   </span><span class="c">! ADD AXIS OPPOSITE, 0=YES,-1=W/L,1=NO LABELS</span>
<span class="w">   </span><span class="n">jyrax</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">38</span><span class="p">)</span><span class="w">                   </span><span class="c">! ADD AXIS OPPOSITE, 0=YES,-1=W/L,1=NO LABELS</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">39</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">xcs</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">39</span><span class="p">)</span><span class="w">   </span><span class="c">! X AXIS TITLE SIZE</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">40</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">ycs</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="w">   </span><span class="c">! Y AXIS TITLE SIZE</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">41</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">tcs</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="c">! OVERALL TITLE SIZE</span>
<span class="w">   </span><span class="n">jgrid</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span><span class="w">                   </span><span class="c">! GRID OPTION, 0=NONE,1=SOLID,2=DOTTED</span>
<span class="w">   </span><span class="n">jlegnd</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="w">                  </span><span class="c">! ADD LEGEND, 0=NONE,1=AUTO,-1=USER</span>
<span class="w">   </span><span class="n">xleg</span><span class="o">=</span><span class="n">xlen</span><span class="o">+</span><span class="mf">0.3</span><span class="w">                 </span><span class="c">! DEFAULT LEGEND LOCATION</span>
<span class="w">   </span><span class="n">yleg</span><span class="o">=</span><span class="mf">0.5</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jlegnd</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">xleg</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span><span class="w">   </span><span class="c">! X LEGEND LOCATION</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jlegnd</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">yleg</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span><span class="w">   </span><span class="c">! Y LEGEND LOCATION</span>
<span class="w">   </span><span class="n">jlegsy</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">46</span><span class="p">)</span><span class="w">                  </span><span class="c">! USE SYMBOL ON LEGEND,0=NO,1=YES</span>
<span class="w">   </span><span class="n">jlegli</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span><span class="w">                  </span><span class="c">! USE LINETYPE ON LEGEND,0=NO,1=YES</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">48</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">csleg</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span><span class="w"> </span><span class="c">! LEGEND CHARACTER SIZE</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">49</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">glen</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">49</span><span class="p">)</span><span class="w">  </span><span class="c">! LEGEND LINE LENGTH</span>
<span class="w">   </span><span class="n">jtcntr</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">                  </span><span class="c">! CENTER TITLE,0=YES,-1=LEFT,1=RIGHT</span>
<span class="w">   </span><span class="n">jszref</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">51</span><span class="p">)</span><span class="w">                  </span><span class="c">! SHOW ZERO REFERENCE,0=NO,1=YES</span>
<span class="w">   </span><span class="n">zref</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<span class="c">!</span>
<span class="w">   </span><span class="n">jline</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span><span class="w">                   </span><span class="c">! USE LINE TYPES,0=NO,1=YES</span>
<span class="w">   </span><span class="n">jcol</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span><span class="w">                    </span><span class="c">! USE COLORS,0=NO,1=YES</span>
<span class="c">!</span>
<span class="c">!     F(54)=FIRST COLOR</span>
<span class="c">!     F(55)=FIRST LINETYPE</span>
<span class="c">!     F(56)=SECOND COLOR</span>
<span class="c">!     F(57)=SECOND LINETYPE</span>
<span class="c">!     ...</span>
<span class="c">!</span>
<span class="w">   </span><span class="n">icoff</span><span class="o">=</span><span class="mi">54</span><span class="w"></span>
<span class="w">   </span><span class="n">iloff</span><span class="o">=</span><span class="mi">55</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     COMPUTE SCALING</span>
<span class="c">!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxauto</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! AUTO SCALE X</span>
<span class="w">      </span><span class="n">x1</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">x2</span><span class="o">=</span><span class="n">x1</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="w"></span>
<span class="w">         </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxuse</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="n">nl</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">nbar</span><span class="w"></span>
<span class="w">            </span><span class="n">xm</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">xm</span><span class="p">,</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">x1</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="n">xx</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">x2</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jebar</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">jxuse</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">xm</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">xm</span><span class="p">,</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">x1</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">               </span><span class="n">xx</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">x2</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">               </span><span class="n">xm</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">xm</span><span class="p">,</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">x1</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">               </span><span class="n">xx</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">x2</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jxlog</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">xm</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">xx</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jxauto</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">jxlgax</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! SMOOTH SCALING</span>
<span class="w">         </span><span class="n">smo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">xm</span><span class="w"></span>
<span class="w">         </span><span class="n">smo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">xx</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">range_</span><span class="p">(</span><span class="n">smo</span><span class="p">,</span><span class="n">xlen</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">dx</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">xx</span><span class="o">=</span><span class="n">xm</span><span class="o">+</span><span class="n">xlen</span><span class="o">*</span><span class="n">dx</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jxlgax</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">   </span><span class="c">! LOG AXIS SCALING</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xm</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">xm</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="nb">int</span><span class="p">(</span><span class="n">xm</span><span class="p">))</span><span class="w"> </span><span class="n">xm</span><span class="o">=</span><span class="n">xm</span><span class="o">-</span><span class="mf">1.0</span><span class="w"></span>
<span class="w">         </span><span class="n">xm</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xx</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">xx</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="nb">int</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span><span class="w"> </span><span class="n">xx</span><span class="o">=</span><span class="n">xx</span><span class="o">+</span><span class="mf">1.0</span><span class="w"></span>
<span class="w">         </span><span class="n">xx</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">xx</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">xm</span><span class="p">)</span><span class="w"> </span><span class="n">xx</span><span class="o">=</span><span class="n">xm</span><span class="o">+</span><span class="mf">1.0</span><span class="w"></span>
<span class="c">!     RETURN SCALE FACTORS USED</span>
<span class="w">      </span><span class="n">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">xm</span><span class="w"></span>
<span class="w">      </span><span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">xx</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span>
<span class="k">   if</span><span class="w"> </span><span class="p">(</span><span class="n">jyauto</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! AUTO SCALE Y</span>
<span class="w">      </span><span class="n">y1</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">ym</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">y2</span><span class="o">=</span><span class="n">y1</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nl</span><span class="p">,</span><span class="n">nbar</span><span class="w"></span>
<span class="w">            </span><span class="n">ym</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">ym</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">y1</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="n">yx</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">yx</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">y2</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">yx</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jebar</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">ym</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">ym</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">y1</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">               </span><span class="n">yx</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">yx</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">y2</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">               </span><span class="n">ym</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">ym</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">y1</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">               </span><span class="n">yx</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">yx</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">y2</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jylog</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">ym</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="n">y1</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">yx</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="n">y2</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jyauto</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">jylgax</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! SMOOTH SCALING</span>
<span class="w">         </span><span class="n">smo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ym</span><span class="w"></span>
<span class="w">         </span><span class="n">smo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">yx</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">range_</span><span class="p">(</span><span class="n">smo</span><span class="p">,</span><span class="n">ylen</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ym</span><span class="p">,</span><span class="n">dy</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">yx</span><span class="o">=</span><span class="n">ym</span><span class="o">+</span><span class="n">ylen</span><span class="o">*</span><span class="n">dy</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jylgax</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">   </span><span class="c">! LOG AXIS SCALING</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ym</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">ym</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="nb">int</span><span class="p">(</span><span class="n">ym</span><span class="p">))</span><span class="w"> </span><span class="n">ym</span><span class="o">=</span><span class="n">ym</span><span class="o">-</span><span class="mf">1.0</span><span class="w"></span>
<span class="w">         </span><span class="n">ym</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">ym</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">yx</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">yx</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="nb">int</span><span class="p">(</span><span class="n">yx</span><span class="p">))</span><span class="w"> </span><span class="n">yx</span><span class="o">=</span><span class="n">yx</span><span class="o">+</span><span class="mf">1.0</span><span class="w"></span>
<span class="w">         </span><span class="n">yx</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">yx</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">yx</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">ym</span><span class="p">)</span><span class="w"> </span><span class="n">yx</span><span class="o">=</span><span class="n">ym</span><span class="o">+</span><span class="mf">1.0</span><span class="w"></span>
<span class="c">!     RETURN SCALE FACTORS USED</span>
<span class="w">      </span><span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">=</span><span class="n">ym</span><span class="w"></span>
<span class="w">      </span><span class="n">f</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span><span class="n">yx</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span>
<span class="k">   </span><span class="n">dx</span><span class="o">=</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">xm</span><span class="p">)</span><span class="o">/</span><span class="n">xlen</span><span class="w"></span>
<span class="w">   </span><span class="n">dy</span><span class="o">=</span><span class="p">(</span><span class="n">yx</span><span class="o">-</span><span class="n">ym</span><span class="p">)</span><span class="o">/</span><span class="n">ylen</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="w">   </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;PRODUCE PLOT&#39;</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     PRODUCE PLOT X AXIS</span>
<span class="c">!</span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! INITIALIZE COLOR AXIS ARRAY</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="w"></span>
<span class="w">         </span><span class="n">ic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">icoff</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ic</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">ic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   endif</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jline</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">newpen_</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">iloff</span><span class="p">)))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxexpsc</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">xcs</span><span class="o">=-</span><span class="n">xcs</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxlgax</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! LINEAR X AXIS</span>
<span class="w">      </span><span class="n">x1</span><span class="o">=</span><span class="n">xlen</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxticks</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">x1</span><span class="o">=-</span><span class="n">xlen</span><span class="w"></span>
<span class="w">      </span><span class="n">na</span><span class="o">=</span><span class="mi">1000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxnum</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxnums</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">-</span><span class="mi">1000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! USE INPUT X AXIS TITLE</span>
<span class="w">         </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">jxtitle</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;1) axisc_&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">axisc_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">xtick</span><span class="p">,</span><span class="n">xcs</span><span class="p">,</span><span class="n">fx</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span><span class="w">        </span><span class="c">! NO X AXIS TITLE</span>
<span class="w">         </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">jxtitle</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;2) axisc_&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">axisc_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">xtick</span><span class="p">,</span><span class="n">xcs</span><span class="p">,</span><span class="n">fx</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jxrax</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">na</span><span class="o">=</span><span class="mi">1000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxrax</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxnums</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">-</span><span class="mi">1000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="c">! USE INPUT X AXIS TITLE</span>
<span class="w">            </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">*</span><span class="n">jxtitle</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;3) axisc_&#39;</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">axisc_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">ylen</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">xtick</span><span class="p">,</span><span class="n">xcs</span><span class="p">,</span><span class="n">fx</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span><span class="w">        </span><span class="c">! NO X AXIS TITLE</span>
<span class="w">            </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">jxtitle</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;4) axisc_&#39;</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">axisc_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">ylen</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">xtick</span><span class="p">,</span><span class="n">xcs</span><span class="p">,</span><span class="n">fx</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">      endif</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="w">   </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">jxlgax</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! LOG X AXIS</span>
<span class="w">      </span><span class="n">x1</span><span class="o">=</span><span class="n">xlen</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxticks</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">x1</span><span class="o">=-</span><span class="n">xlen</span><span class="w"></span>
<span class="w">      </span><span class="n">na</span><span class="o">=</span><span class="mi">1000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxnum</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">10000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxnums</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">-</span><span class="mi">1000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! USE INPUT X AXIS TITLE</span>
<span class="w">         </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">jxtitle</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;5) axislg_&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">axislg_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span><span class="w">        </span><span class="c">! NO X AXIS TITLE</span>
<span class="w">         </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">jxtitle</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;6) axislg_&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">axislg_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jxrax</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">na</span><span class="o">=</span><span class="mi">1000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxrax</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">10000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxnums</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">-</span><span class="mi">1000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="c">! USE INPUT X AXIS TITLE</span>
<span class="w">            </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">*</span><span class="n">jxtitle</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;7) axislg_&#39;</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">axislg_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">ylen</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span><span class="w">    </span><span class="c">! NO X AXIS TITLE</span>
<span class="w">            </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">jxtitle</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;8) axislg_&#39;</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">axislg_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">ylen</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">      endif</span>
<span class="k">   endif</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="c">!     PRODUCE PLOT Y AXIS</span>
<span class="c">!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! INITIALIZE COLOR AXIS ARRAY</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="w"></span>
<span class="w">         </span><span class="n">ic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">icoff</span><span class="o">+</span><span class="mi">6</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ic</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">ic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   endif</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="c">!     PRODUCE PLOT Y AXIS</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jline</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">newpen_</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">iloff</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jyexpsc</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">ycs</span><span class="o">=-</span><span class="n">ycs</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="c">!     PRODUCE PLOT Y AXIS</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jylgax</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! LINEAR Y AXIS</span>
<span class="w">      </span><span class="n">x1</span><span class="o">=</span><span class="n">ylen</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jyticks</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">x1</span><span class="o">=-</span><span class="n">ylen</span><span class="w"></span>
<span class="w">      </span><span class="n">na</span><span class="o">=</span><span class="mi">1000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jynum</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jynums</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">-</span><span class="mi">1000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! USE INPUT Y AXIS TITLE</span>
<span class="w">         </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">jytitle</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;9) axisc_&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">axisc_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ym</span><span class="p">,</span><span class="n">yx</span><span class="p">,</span><span class="n">ytick</span><span class="p">,</span><span class="n">ycs</span><span class="p">,</span><span class="n">fy</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span><span class="w">        </span><span class="c">! NO Y AXIS TITLE</span>
<span class="w">         </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">jytitle</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;10) axisc_&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">axisc_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ym</span><span class="p">,</span><span class="n">yx</span><span class="p">,</span><span class="n">ytick</span><span class="p">,</span><span class="n">ycs</span><span class="p">,</span><span class="n">fy</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jyrax</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">na</span><span class="o">=</span><span class="mi">1000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jyrax</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jynums</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">-</span><span class="mi">1000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="c">! USE INPUT Y AXIS TITLE</span>
<span class="w">            </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="n">jytitle</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;11) axisc_&#39;</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">axisc_</span><span class="p">(</span><span class="n">xlen</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ym</span><span class="p">,</span><span class="n">yx</span><span class="p">,</span><span class="n">ytick</span><span class="p">,</span><span class="n">ycs</span><span class="p">,</span><span class="n">fy</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span><span class="w">        </span><span class="c">! NO Y AXIS TITLE</span>
<span class="w">            </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">jytitle</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;12) axisc_&#39;</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">axisc_</span><span class="p">(</span><span class="n">xlen</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ym</span><span class="p">,</span><span class="n">yx</span><span class="p">,</span><span class="n">ytick</span><span class="p">,</span><span class="n">ycs</span><span class="p">,</span><span class="n">fy</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">      endif</span>
<span class="k">   else if</span><span class="w"> </span><span class="p">(</span><span class="n">jylgax</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! LOG Y AXIS</span>
<span class="w">      </span><span class="n">x1</span><span class="o">=</span><span class="n">ylen</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jyticks</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">x1</span><span class="o">=-</span><span class="n">ylen</span><span class="w"></span>
<span class="w">      </span><span class="n">na</span><span class="o">=</span><span class="mi">1000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jynum</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">10000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jynums</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">-</span><span class="mi">1000</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! USE INPUT Y AXIS TITLE</span>
<span class="w">         </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">jytitle</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;13) axislg_&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">axislg_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="mf">0.0</span><span class="p">,</span><span class="n">xy</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span><span class="w">        </span><span class="c">! NO X AXIS TITLE</span>
<span class="w">         </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">jytitle</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;14) axislg_&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">axislg_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ym</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jyrax</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">na</span><span class="o">=</span><span class="mi">1000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jyrax</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">100</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">+</span><span class="mi">10000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jynums</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="o">-</span><span class="mi">1000</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="c">! USE INPUT Y AXIS TITLE</span>
<span class="w">            </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="n">jytitle</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;15) axislg_&#39;</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">axislg_</span><span class="p">(</span><span class="n">xlen</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ym</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span><span class="w">    </span><span class="c">! NO Y AXIS TITLE</span>
<span class="w">            </span><span class="n">na</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">jytitle</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;16) axislg_&#39;</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">axislg_</span><span class="p">(</span><span class="n">xlen</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ym</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">      endif</span>
<span class="k">   endif</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="c">!     PLOT GRID</span>
<span class="c">!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jgrid</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">icc</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">icoff</span><span class="o">+</span><span class="mi">22</span><span class="p">)))</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">icc</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">icc</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">color_</span><span class="p">(</span><span class="n">icc</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      </span><span class="n">ng</span><span class="o">=</span><span class="n">jgrid</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">i</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">xtick</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">x1</span><span class="o">=</span><span class="n">xlen</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxlgax</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">xlen</span><span class="o">*</span><span class="n">dx</span><span class="o">-</span><span class="n">xm</span><span class="o">+</span><span class="mf">0.001</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">x1</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">xlen</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      </span><span class="n">j</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">ytick</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">y1</span><span class="o">=</span><span class="n">ylen</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jylgax</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">ylen</span><span class="o">*</span><span class="n">dy</span><span class="o">-</span><span class="n">ym</span><span class="o">+</span><span class="mf">0.001</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">y1</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">ylen</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;17) gridll_&#39;</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">gridll_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">ng</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="c">!     ADD TITLE</span>
<span class="c">!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jline</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">newpen_</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">iloff</span><span class="o">+</span><span class="mi">4</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">icc</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">icoff</span><span class="o">+</span><span class="mi">16</span><span class="p">)))</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">icc</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">icc</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">color_</span><span class="p">(</span><span class="n">icc</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      </span><span class="n">icc</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">x1</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">xlen</span><span class="w"></span>
<span class="w">      </span><span class="n">y1</span><span class="o">=</span><span class="n">ylen</span><span class="o">+</span><span class="mf">0.1</span><span class="o">+</span><span class="n">tcs</span><span class="o">*</span><span class="mf">0.2</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtcntr</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">icc</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">x1</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<span class="w">         </span><span class="n">y1</span><span class="o">=</span><span class="n">y1</span><span class="o">-</span><span class="n">tcs</span><span class="o">*</span><span class="mf">0.2</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jtcntr</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">icc</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">x1</span><span class="o">=</span><span class="n">xlen</span><span class="w"></span>
<span class="w">         </span><span class="n">y1</span><span class="o">=</span><span class="n">y1</span><span class="o">-</span><span class="n">tcs</span><span class="o">*</span><span class="mf">0.2</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">jxrax</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">y1</span><span class="o">=</span><span class="n">y1</span><span class="o">+</span><span class="mf">2.5</span><span class="o">*</span><span class="n">xcs</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;18) TITLE&#39;</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">symbol_</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">tcs</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">icc</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="c">!     PLOT DATA IN DESIRED FORM</span>
<span class="c">!</span>
<span class="w">   </span><span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="w"></span>
<span class="w">   </span><span class="n">dy</span><span class="o">=</span><span class="mf">1.0</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">xm</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">dx</span><span class="o">=</span><span class="n">xlen</span><span class="o">/</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">xm</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">yx</span><span class="o">-</span><span class="n">ym</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">dy</span><span class="o">=</span><span class="n">ylen</span><span class="o">/</span><span class="p">(</span><span class="n">yx</span><span class="o">-</span><span class="n">ym</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">zref</span><span class="o">=</span><span class="p">(</span><span class="n">zref</span><span class="o">-</span><span class="n">ym</span><span class="p">)</span><span class="o">*</span><span class="n">dy</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jszref</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! SHOW ZERO REFERENCE LINE</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jline</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">newpen_</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">iloff</span><span class="o">+</span><span class="mi">8</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">icc</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">icoff</span><span class="o">+</span><span class="mi">20</span><span class="p">)))</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">icc</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">icc</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">color_</span><span class="p">(</span><span class="n">icc</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;19) ZERO REFERENCE LINE&#39;</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">zref</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">xlen</span><span class="p">,</span><span class="n">zref</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="c">!</span>
<span class="w">   </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nl</span><span class="p">,</span><span class="n">nbar</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jline</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">newpen_</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">iloff</span><span class="o">+</span><span class="mi">12</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">icc</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">icoff</span><span class="o">+</span><span class="mi">24</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))))</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">icc</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">icc</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">color_</span><span class="p">(</span><span class="n">icc</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      </span><span class="n">ksym</span><span class="o">=</span><span class="nb">mod</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">jsymst</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     IF WE NEED CONNECTING LINES MAKE A CONNECT PASS</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">ipen</span><span class="o">=</span><span class="mi">3</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jconn</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxuse</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">x1</span><span class="o">=</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               </span><span class="n">x1</span><span class="o">=</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">jxlog</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">x1</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">x1</span><span class="o">=</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">xm</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="w"></span>
<span class="w">            </span><span class="n">y1</span><span class="o">=</span><span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jylog</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">y1</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">y1</span><span class="o">=</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">ym</span><span class="p">)</span><span class="o">*</span><span class="n">dy</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">plot_</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">ipen</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ipen</span><span class="o">=</span><span class="mi">2</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     ANOTHER PASS FOR SYMBOLS, ETC.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jconn</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">jebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">jvline</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">jsym</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">      </span><span class="n">isym</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxuse</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">x1</span><span class="o">=</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">x1</span><span class="o">=</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         if</span><span class="w"> </span><span class="p">(</span><span class="n">jxlog</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">x1</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">x1</span><span class="o">=</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">xm</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="w"></span>
<span class="w">         </span><span class="n">y1</span><span class="o">=</span><span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jylog</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">y1</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">y1</span><span class="o">=</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">ym</span><span class="p">)</span><span class="o">*</span><span class="n">dy</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jsym</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! SYMBOLS</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">isym</span><span class="p">,</span><span class="n">jsym</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">symbol_</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">symsiz</span><span class="p">,</span><span class="nb">char</span><span class="p">(</span><span class="n">ksym</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         if</span><span class="w"> </span><span class="p">(</span><span class="n">jvline</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! VERTICAL LINE</span>
<span class="w">            </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">zref</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         if</span><span class="w"> </span><span class="p">(</span><span class="n">jebar</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! ERROR BAR</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jline</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">newpen_</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">iloff</span><span class="o">+</span><span class="mi">10</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxuse</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">x2</span><span class="o">=</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">x3</span><span class="o">=</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jxlog</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">x2</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">x3</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">               </span><span class="n">x2</span><span class="o">=</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">xm</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="w"></span>
<span class="w">               </span><span class="n">x3</span><span class="o">=</span><span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">xm</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               </span><span class="n">x2</span><span class="o">=</span><span class="n">x1</span><span class="w"></span>
<span class="w">               </span><span class="n">x3</span><span class="o">=</span><span class="n">x1</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            </span><span class="n">y2</span><span class="o">=</span><span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">y3</span><span class="o">=</span><span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jylog</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">y2</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">y2</span><span class="p">)</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">y3</span><span class="o">=</span><span class="n">alog10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">y3</span><span class="p">)</span><span class="o">+</span><span class="mf">1.e-34</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            </span><span class="n">y2</span><span class="o">=</span><span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">ym</span><span class="p">)</span><span class="o">*</span><span class="n">dy</span><span class="w"></span>
<span class="w">            </span><span class="n">y3</span><span class="o">=</span><span class="p">(</span><span class="n">y3</span><span class="o">-</span><span class="n">ym</span><span class="p">)</span><span class="o">*</span><span class="n">dy</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">2.</span><span class="nb">or</span><span class="p">.</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! ERROR BAR TOP</span>
<span class="w">               </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="o">-</span><span class="n">ebar</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="o">+</span><span class="n">ebar</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">3.</span><span class="nb">or</span><span class="p">.</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">move_</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">ebar</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="n">ebar</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">kebar</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! CONNECT LINE</span>
<span class="w">               </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">y3</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! DOUBLE CONN V LINE</span>
<span class="w">               </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">ebar</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">ebar</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span><span class="n">y3</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">ebar</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span><span class="n">y3</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="n">ebar</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! DOUBLE CONN HLINE</span>
<span class="w">               </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="o">-</span><span class="n">ebar</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">y3</span><span class="o">-</span><span class="n">ebar</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">y3</span><span class="o">+</span><span class="n">ebar</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="o">+</span><span class="n">ebar</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! VERTICAL RECT</span>
<span class="w">               </span><span class="k">call </span><span class="n">rect_</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">ebar</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">x1</span><span class="o">+</span><span class="n">ebar</span><span class="p">,</span><span class="n">y3</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! RECT</span>
<span class="w">               </span><span class="k">call </span><span class="n">rect_</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">y3</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">jebar</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! X MARK</span>
<span class="w">               </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">ebar</span><span class="p">,</span><span class="n">y1</span><span class="o">-</span><span class="n">ebar</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">ebar</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="n">ebar</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">ebar</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="n">ebar</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">ebar</span><span class="p">,</span><span class="n">y1</span><span class="o">-</span><span class="n">ebar</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">2.</span><span class="nb">or</span><span class="p">.</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! BAR BOTTOM</span>
<span class="w">               </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">y3</span><span class="o">-</span><span class="n">ebar</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">y3</span><span class="o">+</span><span class="n">ebar</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">3.</span><span class="nb">or</span><span class="p">.</span><span class="n">kebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">move_</span><span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">ebar</span><span class="p">,</span><span class="n">y3</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">ebar</span><span class="p">,</span><span class="n">y3</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">         endif</span>
<span class="k">         if</span><span class="w"> </span><span class="p">(</span><span class="n">jsym</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">jconn</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="w">  </span><span class="n">jebar</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">jvline</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">move_</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span><span class="w"> </span><span class="c">! DOTS ONLY</span>
<span class="w">            </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         </span><span class="n">isym</span><span class="o">=</span><span class="n">isym</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">    enddo</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="c">!     ADD LEGEND</span>
<span class="c">!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jlegnd</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;20) ADD LEGEND&#39;</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nl</span><span class="w"></span>
<span class="w">         </span><span class="n">x1</span><span class="o">=</span><span class="n">xleg</span><span class="o">+</span><span class="n">csleg</span><span class="o">*</span><span class="mf">1.5</span><span class="w"></span>
<span class="w">         </span><span class="n">y1</span><span class="o">=</span><span class="n">yleg</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">csleg</span><span class="o">*</span><span class="mf">1.5</span><span class="o">+</span><span class="n">csleg</span><span class="o">*</span><span class="mf">0.5</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">icc</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">icoff</span><span class="o">+</span><span class="mi">24</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))))</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">icc</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">icc</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">color_</span><span class="p">(</span><span class="n">icc</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         if</span><span class="w"> </span><span class="p">(</span><span class="n">jlegli</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">jline</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">newpen_</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">iloff</span><span class="o">+</span><span class="mi">12</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">draw_</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">glen</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="o">+</span><span class="n">glen</span><span class="o">*</span><span class="mf">0.5</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         if</span><span class="w"> </span><span class="p">(</span><span class="n">jlegsy</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">icc</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">jsymst</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">symbol_</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">symsiz</span><span class="p">,</span><span class="w"> </span><span class="nb">char</span><span class="p">(</span><span class="n">icc</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         if</span><span class="w"> </span><span class="p">(</span><span class="n">jlegli</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="o">+</span><span class="n">glen</span><span class="o">*</span><span class="mf">0.5</span><span class="w"></span>
<span class="w">         </span><span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="o">+</span><span class="n">csleg</span><span class="o">*</span><span class="mf">0.7</span><span class="w"></span>
<span class="w">         </span><span class="n">y1</span><span class="o">=</span><span class="n">y1</span><span class="o">-</span><span class="n">csleg</span><span class="o">*</span><span class="mf">0.5</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nc</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">jline</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">newpen_</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">iloff</span><span class="o">+</span><span class="mi">6</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jcol</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">icc</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">icoff</span><span class="o">+</span><span class="mi">18</span><span class="p">)))</span><span class="w"></span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">icc</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">icc</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">color_</span><span class="p">(</span><span class="n">icc</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">            call </span><span class="n">symbol_</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">csleg</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="n">nc</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">      enddo</span>
<span class="k">   endif</span><span class="w"></span>
<span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<span class="c">!     FINISH UP</span>
<span class="w">   </span><span class="k">call </span><span class="n">move_</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span><span class="w">   </span><span class="c">!PEN UP</span>
<span class="k">end subroutine </span><span class="n">graph</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-xs-6 col-md-6"><p>M_graph was developed by John S. Urban<br>&copy; 2023 
</p>
          </div>
          <div class="col-xs-6 col-md-6">
            <p class="text-right">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2023-04-18 07:36              </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
         ================================================== -->
         <!-- Placed at the end of the document so the pages load faster -->
    <!--
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        -->
        <script src="../js/bootstrap.min.js"></script>
        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <script src="../js/ie10-viewport-bug-workaround.js"></script>

        <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>